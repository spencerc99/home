---
import "./Status.scss";
const stream = await fetch("https://status.spencerchang.me/api/me").then(
  (res) => res.json()
);

function formatDate(date: Date) {
  return date
    .toLocaleString("en-US", {
      month: "2-digit",
      day: "2-digit",
      hour: "2-digit",
      minute: "2-digit",
      hour12: false,
    })
    .replace(", ", "|")
    .replace("/", ".");
}

console.log(stream);
---

<div
  class="activities"
  title="this is a set of live attributes from what I consume and make streamed to this little status bar. The numbers represent Spencer epoch time, a play on UNIX epoch."
>
  <h3>Latest Activities</h3>
  <ul>
    {
      stream.map((element, idx) => (
        <li>
          [
          <span class="date">
            <>
              <span class="timestamp">{formatDate(element.date)}</span>
              <span class="epoch">{element.birthdayEpoch}</span>
            </>
          </span>
          ] <Fragment set:html={element.displayHTML} />
        </li>
      ))
    }
  </ul>
</div>
